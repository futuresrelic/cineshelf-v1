<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineShelf - Physical Media Collection Manager</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json?v=2">
    
    <!-- iOS and PWA meta tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CineShelf">
    
    <!-- Icon for iOS -->
    <link rel="apple-touch-icon" href="icon-180.png">
    
    <!-- External CSS -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- External JavaScript Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
</head>
<body>
    <div class="sticky-header-container">
        <div class="header">
            <h1>
                <img src="logo.png" alt="CineShelf Logo" class="header-logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
                <span style="display: none;">üé¨</span>
                CineShelf
            </h1>
            <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem;">Physical Media Collection Manager</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('scan')">Scan</button>
            <button class="tab admin-feature" onclick="switchTab('covers')">Covers</button>
            <button class="tab" onclick="switchTab('collection')">Movies</button>
            <button class="tab" onclick="switchTab('wishlist')">Wishlist</button>
            <button class="tab admin-only" onclick="switchTab('resolve')">Resolve</button>
            <button class="tab admin-only" onclick="switchTab('data')">Data</button>
            <button class="tab admin-only" onclick="switchTab('settings')">Settings</button>
            <button class="tab admin-only" onclick="switchTab('design')">Design</button>
        </div>
    </div>

    <!-- User Switcher - Always Visible at Top -->
    <div class="detail-section" style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px; margin: 1rem; margin-bottom: 0;">
        <div class="form-group" style="display: flex; align-items: center; gap: 1rem;">
            <label for="currentUser" style="color: white; margin: 0;">üë§ Current User:</label>
            <select id="currentUser" onchange="App.switchUser(this.value)" style="flex: 1; max-width: 200px;" autocomplete="username">
                <option value="default">Default User</option>
                <option value="admin">Admin</option>
                <option value="klindakoil">klindakoil</option>
            </select>
        </div>
    </div>

    <!-- Scan Tab -->
    <div id="scan" class="tab-content active">
        
        <div id="resolveNextSection" class="resolve-next-section admin-only" style="display: none;">
            <div class="resolve-next-title">üîç Resolving Unmatched Item</div>
            <div id="resolveNextInfo" class="resolve-next-info"></div>
            <div class="resolve-next-actions">
                <button onclick="App.skipToNextUnresolved()" class="btn btn-secondary">‚è≠Ô∏è Skip This Item</button>
                <button onclick="App.deleteCurrentResolveItem()" class="btn btn-danger">üóëÔ∏è Delete This Item</button>
            </div>
        </div>

        <div id="editSection" class="edit-section" style="display: none;">
            <div class="edit-section-title">‚úèÔ∏è Editing Movie</div>
            <div id="editInfo" class="edit-section-info"></div>
            <div class="edit-section-actions">
                <button onclick="App.cancelEdit()" class="btn btn-secondary">‚ùå Cancel Edit</button>
                <button onclick="App.saveEditChanges()" class="btn">üíæ Save Changes</button>
            </div>
        </div>

        <form id="movieForm">
            <div class="form-group">
                <label for="movieTitle">Movie Title:</label>
                <input type="text" id="movieTitle" name="movieTitle" required autocomplete="off">
            </div>
            
            <div class="form-row">
                <button type="button" id="searchBtn" class="btn btn-secondary">
                    <span id="searchBtnText">üîç Search Movie Database</span>
                    <div id="searchLoader" class="spinner" style="display: none;"></div>
                </button>
                
                <div class="imdb-lookup">
                    <input type="text" id="imdbId" name="imdbId" placeholder="IMDB ID (e.g., tt0219965)" autocomplete="off">
                    <button type="button" id="imdbBtn" class="btn btn-secondary">üìã Lookup by IMDB ID</button>
                </div>
            </div>
        <div id="status" class="status"></div>

            <div class="form-row">
                <div class="form-group">
                    <label for="format">Format:</label>
                    <select id="format" name="format" autocomplete="off">
                        <option value="">Select Format</option>
                        <option value="DVD">DVD</option>
                        <option value="Blu-ray">Blu-ray</option>
                        <option value="4K UHD">4K UHD</option>
                        <option value="VHS">VHS</option>
                        <option value="Digital">Digital</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="region">Region:</label>
                    <select id="region" name="region" autocomplete="country">
                        <option value="">Any Region</option>
                        <option value="Region A">Region A</option>
                        <option value="Region B">Region B</option>
                        <option value="Region C">Region C</option>
                        <option value="Region 1">Region 1</option>
                        <option value="Region 2">Region 2</option>
                        <option value="Region 3">Region 3</option>
                        <option value="Region 4">Region 4</option>
                        <option value="Region Free">Region Free</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="discs">Number of Discs:</label>
                    <input type="number" id="discs" name="discs" min="1" max="50" value="1" autocomplete="off">
                </div>
                
                <div class="form-group">
                    <label for="edition">Edition:</label>
                    <select id="edition" name="edition" autocomplete="off">
                        <option value="">Select Edition (Optional)</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="languages">Audio Languages:</label>
                <input type="text" id="languages" name="languages" placeholder="e.g., English, French, Spanish" autocomplete="language">
            </div>

            <div class="form-group">
                <label for="upc">UPC/Barcode:</label>
                <div style="display: flex; gap: 0.5rem;">
                    <input type="text" id="upc" name="upc" placeholder="Barcode number" autocomplete="off" style="flex: 1;">
                    <button type="button" id="scanUpcBtn" class="btn btn-secondary" style="white-space: nowrap;">üì± Scan UPC</button>
                </div>
            </div>

            <div class="form-group">
                <label for="notes">Notes:</label>
                <textarea id="notes" name="notes" rows="3" placeholder="Additional notes about this copy" autocomplete="off"></textarea>
            </div>

            <div id="formButtons" class="form-buttons">
                <button type="submit" name="collection" class="btn">üìö Add to Collection</button>
                <button type="submit" name="wishlist" class="btn btn-secondary">‚ù§Ô∏è Add to Wishlist</button>
            </div>
        </form>
    </div>

    <!-- Covers Tab -->
    <div id="covers" class="tab-content admin-feature">
        <div id="coverStatus" class="status"></div>
        
        <div class="api-key-section">
            <label for="apiKey">OpenAI API Key:</label>
            <input type="password" id="apiKey" name="apiKey" placeholder="sk-..." style="margin-bottom: 0.5rem;" autocomplete="current-password">
            <button class="test-btn" onclick="CoverScanner.testAPI()">üîß Test API Key</button>
        </div>
        
        <div class="camera-section">
            <input type="file" id="fileInput" name="fileInput" accept="image/*" multiple style="display: none;">
            <button onclick="document.getElementById('fileInput').click()" class="btn btn-secondary">üìÅ Upload Images</button>
            
            <div class="camera-controls">
                <button onclick="CoverScanner.startCamera()">üì∑ Start Camera</button>
                <button onclick="CoverScanner.captureImage()" id="captureBtn" disabled>üì∏ Capture</button>
                <button onclick="CoverScanner.stopCamera()">‚èπÔ∏è Stop</button>
                <button onclick="CoverScanner.clearImages()" id="clearBtn" class="clear-btn" disabled>üóëÔ∏è Clear</button>
            </div>
            
            <video id="coverVideo" autoplay></video>
            <canvas id="coverCanvas"></canvas>
            
            <div id="capturedImages" class="captured-images-container"></div>
            
            <button onclick="CoverScanner.analyzeImages()" id="analyzeBtn" class="btn" disabled>ü§ñ Extract Titles with AI</button>
        </div>
        
        <div id="coverLoading" class="loading" style="display: none;">
            Analyzing DVD covers with AI... Please wait.
        </div>
        
        <div class="titles-section">
            <div id="outputArea"></div>
        </div>
    </div>

    <!-- Collection Tab -->
<div id="collection" class="tab-content">
    <div class="view-controls">
    <!-- TOP ROW: Slider + View Buttons -->
    <div class="view-controls-row">
        <!-- Slider on LEFT -->
        <div class="size-slider-control">
            <span>üìê Cards:</span>
            <input type="range" id="collectionGridSlider" min="2" max="8" value="4" step="1" 
                   oninput="App.updateGridColumns('collection', this.value)">
            <span id="collectionGridValue">4</span>
        </div>
        
        <!-- View Buttons on RIGHT -->
        <div class="view-toggle">
            <button class="view-btn active" onclick="App.setViewMode('collection', 'grid')" title="Grid View">‚äû</button>
            <button class="view-btn admin-feature" onclick="App.setViewMode('collection', 'small')" title="Small Cards">‚ä°</button>
            <button class="view-btn admin-feature" onclick="App.setViewMode('collection', 'detail')" title="Detail Cards">‚äü</button>
            <button class="view-btn admin-feature" onclick="App.setViewMode('collection', 'list')" title="List View">‚ò∞</button>
        </div>
    </div>
    
    <!-- Sort Controls -->
    <div class="sort-controls">
        <div class="form-group">
            <label for="collectionSort">Sort by:</label>
            <select id="collectionSort" onchange="App.sortMovies('collection', this.value)" autocomplete="off">
                <option value="title">Title (A-Z)</option>
                <option value="title-desc">Title (Z-A)</option>
                <option value="year">Year (Oldest First)</option>
                <option value="year-desc">Year (Newest First)</option>
                <option value="rating">Rating (Lowest First)</option>
                <option value="rating-desc">Rating (Highest First)</option>
                <option value="runtime" class="admin-feature">Runtime (Shortest First)</option>
                <option value="runtime-desc" class="admin-feature">Runtime (Longest First)</option>
                <option value="director" class="admin-feature">Director (A-Z)</option>
                <option value="director-desc" class="admin-feature">Director (Z-A)</option>
                <option value="genre">Genre (A-Z)</option>
                <option value="genre-desc">Genre (Z-A)</option>
                <option value="format" class="admin-feature">Format (A-Z)</option>
                <option value="format-desc" class="admin-feature">Format (Z-A)</option>
                <option value="added">Date Added (Oldest First)</option>
                <option value="added-desc">Date Added (Newest First)</option>
            </select>
        </div>
    </div>
    
    <!-- Alphabetical Filter -->
    <div class="filter-section">
        <div class="filter-header">
            <span class="filter-label">Filter:</span>
            <span id="collectionFilterCounter" class="filter-counter">0 movies</span>
        </div>
        <div class="letter-filter">
            <button class="letter-filter-btn active" data-letter="ALL" onclick="App.setLetterFilter('collection', 'ALL')">All</button>
            <button class="letter-filter-btn" data-letter="0-9" onclick="App.setLetterFilter('collection', '0-9')">#</button>
            <button class="letter-filter-btn" data-letter="A" onclick="App.setLetterFilter('collection', 'A')">A</button>
            <button class="letter-filter-btn" data-letter="B" onclick="App.setLetterFilter('collection', 'B')">B</button>
            <button class="letter-filter-btn" data-letter="C" onclick="App.setLetterFilter('collection', 'C')">C</button>
            <button class="letter-filter-btn" data-letter="D" onclick="App.setLetterFilter('collection', 'D')">D</button>
            <button class="letter-filter-btn" data-letter="E" onclick="App.setLetterFilter('collection', 'E')">E</button>
            <button class="letter-filter-btn" data-letter="F" onclick="App.setLetterFilter('collection', 'F')">F</button>
            <button class="letter-filter-btn" data-letter="G" onclick="App.setLetterFilter('collection', 'G')">G</button>
            <button class="letter-filter-btn" data-letter="H" onclick="App.setLetterFilter('collection', 'H')">H</button>
            <button class="letter-filter-btn" data-letter="I" onclick="App.setLetterFilter('collection', 'I')">I</button>
            <button class="letter-filter-btn" data-letter="J" onclick="App.setLetterFilter('collection', 'J')">J</button>
            <button class="letter-filter-btn" data-letter="K" onclick="App.setLetterFilter('collection', 'K')">K</button>
            <button class="letter-filter-btn" data-letter="L" onclick="App.setLetterFilter('collection', 'L')">L</button>
            <button class="letter-filter-btn" data-letter="M" onclick="App.setLetterFilter('collection', 'M')">M</button>
            <button class="letter-filter-btn" data-letter="N" onclick="App.setLetterFilter('collection', 'N')">N</button>
            <button class="letter-filter-btn" data-letter="O" onclick="App.setLetterFilter('collection', 'O')">O</button>
            <button class="letter-filter-btn" data-letter="P" onclick="App.setLetterFilter('collection', 'P')">P</button>
            <button class="letter-filter-btn" data-letter="Q" onclick="App.setLetterFilter('collection', 'Q')">Q</button>
            <button class="letter-filter-btn" data-letter="R" onclick="App.setLetterFilter('collection', 'R')">R</button>
            <button class="letter-filter-btn" data-letter="S" onclick="App.setLetterFilter('collection', 'S')">S</button>
            <button class="letter-filter-btn" data-letter="T" onclick="App.setLetterFilter('collection', 'T')">T</button>
            <button class="letter-filter-btn" data-letter="U" onclick="App.setLetterFilter('collection', 'U')">U</button>
            <button class="letter-filter-btn" data-letter="V" onclick="App.setLetterFilter('collection', 'V')">V</button>
            <button class="letter-filter-btn" data-letter="W" onclick="App.setLetterFilter('collection', 'W')">W</button>
            <button class="letter-filter-btn" data-letter="X" onclick="App.setLetterFilter('collection', 'X')">X</button>
            <button class="letter-filter-btn" data-letter="Y" onclick="App.setLetterFilter('collection', 'Y')">Y</button>
            <button class="letter-filter-btn" data-letter="Z" onclick="App.setLetterFilter('collection', 'Z')">Z</button>
        </div>
    </div>
</div>
    
    <div id="collectionGrid" class="movie-grid"></div>
    <div id="collectionEmpty" class="empty-state">
        <h3>No Movies in Collection</h3>
        <p>Start by scanning or adding movies to build your collection!</p>
    </div>
</div>

    <!-- Wishlist Tab -->
<div id="wishlist" class="tab-content">
    <div class="view-controls">
        <!-- TOP ROW: Slider + View Buttons -->
        <div class="view-controls-row">
            <!-- Slider on LEFT -->
            <div class="size-slider-control">
                <span>üìê Cards:</span>
                <input type="range" id="wishlistGridSlider" min="2" max="8" value="4" step="1" 
                       oninput="App.updateGridColumns('wishlist', this.value)">
                <span id="wishlistGridValue">4</span>
            </div>
            
            <!-- View Buttons on RIGHT -->
            <div class="view-toggle">
                <button class="view-btn active" onclick="App.setViewMode('wishlist', 'grid')" title="Grid View">‚äû</button>
                <button class="view-btn admin-feature" onclick="App.setViewMode('wishlist', 'small')" title="Small Cards">‚ä°</button>
                <button class="view-btn admin-feature" onclick="App.setViewMode('wishlist', 'detail')" title="Detail Cards">‚äü</button>
                <button class="view-btn admin-feature" onclick="App.setViewMode('wishlist', 'list')" title="List View">‚ò∞</button>
            </div>
        </div>
        
        <!-- Sort Controls -->
        <div class="sort-controls">
            <div class="form-group">
                <label for="wishlistSort">Sort by:</label>
                <select id="wishlistSort" onchange="App.sortMovies('wishlist', this.value)" autocomplete="off">
                    <option value="title">Title (A-Z)</option>
                    <option value="title-desc">Title (Z-A)</option>
                    <option value="year">Year (Oldest First)</option>
                    <option value="year-desc">Year (Newest First)</option>
                    <option value="rating">Rating (Lowest First)</option>
                    <option value="rating-desc">Rating (Highest First)</option>
                    <option value="runtime" class="admin-feature">Runtime (Shortest First)</option>
                    <option value="runtime-desc" class="admin-feature">Runtime (Longest First)</option>
                    <option value="director" class="admin-feature">Director (A-Z)</option>
                    <option value="director-desc" class="admin-feature">Director (Z-A)</option>
                    <option value="genre">Genre (A-Z)</option>
                    <option value="genre-desc">Genre (Z-A)</option>
                    <option value="format" class="admin-feature">Format (A-Z)</option>
                    <option value="format-desc" class="admin-feature">Format (Z-A)</option>
                    <option value="added">Date Added (Oldest First)</option>
                    <option value="added-desc">Date Added (Newest First)</option>
                </select>
            </div>
        </div>
        
        <!-- Alphabetical Filter -->
        <div class="filter-section">
            <div class="filter-header">
                <span class="filter-label">Filter:</span>
                <span id="wishlistFilterCounter" class="filter-counter">0 movies</span>
            </div>
            <div class="letter-filter">
                <button class="letter-filter-btn active" data-letter="ALL" onclick="App.setLetterFilter('wishlist', 'ALL')">All</button>
                <button class="letter-filter-btn" data-letter="0-9" onclick="App.setLetterFilter('wishlist', '0-9')">#</button>
                <button class="letter-filter-btn" data-letter="A" onclick="App.setLetterFilter('wishlist', 'A')">A</button>
                <button class="letter-filter-btn" data-letter="B" onclick="App.setLetterFilter('wishlist', 'B')">B</button>
                <button class="letter-filter-btn" data-letter="C" onclick="App.setLetterFilter('wishlist', 'C')">C</button>
                <button class="letter-filter-btn" data-letter="D" onclick="App.setLetterFilter('wishlist', 'D')">D</button>
                <button class="letter-filter-btn" data-letter="E" onclick="App.setLetterFilter('wishlist', 'E')">E</button>
                <button class="letter-filter-btn" data-letter="F" onclick="App.setLetterFilter('wishlist', 'F')">F</button>
                <button class="letter-filter-btn" data-letter="G" onclick="App.setLetterFilter('wishlist', 'G')">G</button>
                <button class="letter-filter-btn" data-letter="H" onclick="App.setLetterFilter('wishlist', 'H')">H</button>
                <button class="letter-filter-btn" data-letter="I" onclick="App.setLetterFilter('wishlist', 'I')">I</button>
                <button class="letter-filter-btn" data-letter="J" onclick="App.setLetterFilter('wishlist', 'J')">J</button>
                <button class="letter-filter-btn" data-letter="K" onclick="App.setLetterFilter('wishlist', 'K')">K</button>
                <button class="letter-filter-btn" data-letter="L" onclick="App.setLetterFilter('wishlist', 'L')">L</button>
                <button class="letter-filter-btn" data-letter="M" onclick="App.setLetterFilter('wishlist', 'M')">M</button>
                <button class="letter-filter-btn" data-letter="N" onclick="App.setLetterFilter('wishlist', 'N')">N</button>
                <button class="letter-filter-btn" data-letter="O" onclick="App.setLetterFilter('wishlist', 'O')">O</button>
                <button class="letter-filter-btn" data-letter="P" onclick="App.setLetterFilter('wishlist', 'P')">P</button>
                <button class="letter-filter-btn" data-letter="Q" onclick="App.setLetterFilter('wishlist', 'Q')">Q</button>
                <button class="letter-filter-btn" data-letter="R" onclick="App.setLetterFilter('wishlist', 'R')">R</button>
                <button class="letter-filter-btn" data-letter="S" onclick="App.setLetterFilter('wishlist', 'S')">S</button>
                <button class="letter-filter-btn" data-letter="T" onclick="App.setLetterFilter('wishlist', 'T')">T</button>
                <button class="letter-filter-btn" data-letter="U" onclick="App.setLetterFilter('wishlist', 'U')">U</button>
                <button class="letter-filter-btn" data-letter="V" onclick="App.setLetterFilter('wishlist', 'V')">V</button>
                <button class="letter-filter-btn" data-letter="W" onclick="App.setLetterFilter('wishlist', 'W')">W</button>
                <button class="letter-filter-btn" data-letter="X" onclick="App.setLetterFilter('wishlist', 'X')">X</button>
                <button class="letter-filter-btn" data-letter="Y" onclick="App.setLetterFilter('wishlist', 'Y')">Y</button>
                <button class="letter-filter-btn" data-letter="Z" onclick="App.setLetterFilter('wishlist', 'Z')">Z</button>
            </div>
        </div>
    </div>
    
    <div id="wishlistGrid" class="movie-grid"></div>
    <div id="wishlistEmpty" class="empty-state">
        <h3>No Movies in Wishlist</h3>
        <p>Add movies you want to buy to your wishlist!</p>
    </div>
</div>

    <!-- Resolve Tab (Admin Only) -->
    <div id="resolve" class="tab-content admin-only">
        <div id="resolveList"></div>
        <div id="resolveEmpty" class="empty-state">
            <h3>All Movies Resolved</h3>
            <p>All your movies have complete information.</p>
        </div>
    </div>

    <!-- Data Management Tab (Admin Only) -->
    <div id="data" class="tab-content admin-only">
        <!-- User Management Section -->
        <div class="detail-section">
            <div class="detail-title">üë• User Management</div>
            <div class="form-group">
                <label for="dataCurrentUser">Current User (Data Tab):</label>
                <select id="dataCurrentUser" onchange="App.switchUser(this.value)" autocomplete="username">
                    <option value="default">Default User</option>
                </select>
            </div>
            <div class="form-group">
                <label for="newUserName">Add New User:</label>
                <input type="text" id="newUserName" name="newUserName" placeholder="New user name" autocomplete="username">
                <button onclick="App.addUser()" class="btn btn-secondary">Add User</button>
            </div>
            <button onclick="App.deleteCurrentUser()" class="btn btn-danger">Delete Current User</button>
        </div>

        <!-- Admin Management Section -->
        <div class="detail-section">
            <div id="adminControls"></div>
        </div>

        <!-- Statistics Section -->
        <div class="detail-section">
            <div class="detail-title">üìä Collection Statistics</div>
            <div id="stats"></div>
        </div>

        <!-- Local Data Management -->
        <div class="detail-section">
            <div class="detail-title">üíæ Local Data Management</div>
            <div class="form-group">
                <button onclick="App.exportData()" class="btn">üì• Export Collection (CSV)</button>
            </div>

            <div class="form-group">
                <label for="importFile" class="file-label">üì§ Import Collection Data</label>
                <input type="file" id="importFile" name="importFile" class="file-input" accept=".csv,.json" onchange="App.importData(event)">
            </div>

            <div class="form-group">
                <button onclick="App.clearAllData()" class="btn btn-danger">üóëÔ∏è Clear All Data</button>
            </div>
        </div>

        <!-- Server Backup Section -->
        <div class="detail-section">
            <div class="detail-title">‚òÅÔ∏è Server Backup</div>
            <div class="form-group">
                <button onclick="App.backupToServer()" class="btn">üì§ Backup to Server</button>
            </div>
            <div class="form-group">
                <button onclick="App.restoreFromServer()" class="btn btn-secondary">üì• Restore from Server</button>
            </div>
            <div id="serverStatus" class="status" style="display: none;"></div>
            <div class="detail-text" style="font-size: 0.8rem; opacity: 0.8; margin-top: 0.5rem;">
                Note: Server backup requires server-side script setup. Data is saved as JSON files on your web server.
            </div>
        </div>
    </div>

    <!-- Settings Tab (Admin Only) -->
    <div id="settings" class="tab-content admin-only">
        <div class="detail-section">
            <div class="detail-title">‚öôÔ∏è Application Settings</div>
            <p class="detail-text">Current Version: <span id="appVersion">v2.1.0</span> ‚Ä¢ Last Updated: <span id="lastUpdate">Today</span></p>
        </div>

        <div class="detail-section">
            <div class="detail-title">üîç Search & Display Settings</div>
            
            <div class="form-group">
                <label for="searchResultsLimit">Search Results Limit:</label>
                <select id="searchResultsLimit" onchange="App.updateSetting('searchResultsLimit', this.value)" autocomplete="off">
                    <option value="5">5 results</option>
                    <option value="10">10 results</option>
                    <option value="15">15 results</option>
                    <option value="20">20 results</option>
                    <option value="25">25 results</option>
                </select>
            </div>

            <div class="form-group">
                <label for="defaultViewMode">Default View Mode:</label>
                <select id="defaultViewMode" onchange="App.updateSetting('defaultViewMode', this.value)" autocomplete="off">
                    <option value="grid">Grid View</option>
                    <option value="small">Small Cards</option>
                    <option value="detail">Detail Cards</option>
                    <option value="list">List View</option>
                </select>
            </div>
        </div>

        <div class="detail-section">
            <div class="detail-title">üé® Appearance Settings</div>

            <div class="form-group">
                <label for="appTheme">Theme:</label>
                <select id="appTheme" onchange="App.updateSetting('appTheme', this.value)" autocomplete="off">
                    <option value="cosmic">Cosmic (Default)</option>
                    <option value="dark">Dark</option>
                    <option value="light">Light</option>
                    <option value="ocean">Ocean</option>
                    <option value="forest">Forest</option>
                    <option value="sunset">Sunset</option>
                    <option value="royal">Royal</option>
                    <option value="minimal">Minimal</option>
                </select>
            </div>

            <div class="form-group">
                <label for="animationSpeed">Animation Speed:</label>
                <select id="animationSpeed" onchange="App.updateSetting('animationSpeed', this.value)" autocomplete="off">
                    <option value="fast">Fast</option>
                    <option value="normal">Normal</option>
                    <option value="slow">Slow</option>
                    <option value="none">No Animations</option>
                </select>
            </div>

            <div class="form-group">
                <label for="cardStyle">Card Style:</label>
                <select id="cardStyle" onchange="App.updateSetting('cardStyle', this.value)" autocomplete="off">
                    <option value="rounded">Rounded</option>
                    <option value="sharp">Sharp Corners</option>
                    <option value="ultra-round">Ultra Round</option>
                    <option value="minimal">Minimal</option>
                </select>
            </div>

            <div class="form-group checkbox-group">
                <input type="checkbox" id="compactMode" onchange="App.updateSetting('compactMode', this.checked)">
                <label for="compactMode">Compact Mode</label>
            </div>
        </div>

        <div class="detail-section">
            <div class="detail-title">üîß Advanced Settings</div>

            <div class="form-group checkbox-group">
                <input type="checkbox" id="autoResolve" onchange="App.updateSetting('autoResolve', this.checked)">
                <label for="autoResolve">Auto-resolve Movies from Shared Database</label>
            </div>

            <div class="form-group checkbox-group">
                <input type="checkbox" id="barcodeBeep" onchange="App.updateSetting('barcodeBeep', this.checked)">
                <label for="barcodeBeep">Barcode Scanner Sound</label>
            </div>

            <div class="form-group checkbox-group">
                <input type="checkbox" id="scannerVibration" onchange="App.updateSetting('scannerVibration', this.checked)">
                <label for="scannerVibration">Scanner Vibration (Mobile)</label>
            </div>

            <div class="form-group checkbox-group">
                <input type="checkbox" id="autoBackup" onchange="App.updateSetting('autoBackup', this.checked)">
                <label for="autoBackup">Auto Server Backup (Experimental)</label>
            </div>

            <div class="form-group checkbox-group">
                <input type="checkbox" id="debugMode" onchange="App.updateSetting('debugMode', this.checked)">
                <label for="debugMode">Debug Mode (Console Logging)</label>
            </div>
        </div>

        <div class="detail-section">
            <div class="detail-title">üîë API Keys</div>
            
            <div class="form-group">
                <label for="openaiApiKey">OpenAI API Key (for Cover Scanner):</label>
                <input type="password" id="openaiApiKey" name="openaiApiKey" placeholder="sk-..." onchange="App.updateSetting('openaiApiKey', this.value)" autocomplete="current-password">
            </div>

            <div class="form-group">
                <label for="tmdbApiKey">TMDB API Key (Custom):</label>
                <input type="password" id="tmdbApiKey" name="tmdbApiKey" placeholder="Custom TMDB key (optional)" onchange="App.updateSetting('tmdbApiKey', this.value)" autocomplete="current-password">
            </div>
        </div>

        <div class="detail-section">
            <div class="detail-title">üìù Custom Editions</div>
            <div class="form-group">
                <label for="newCustomEdition">Add Custom Edition:</label>
                <input type="text" id="newCustomEdition" name="newCustomEdition" placeholder="e.g., Director's Cut" autocomplete="off">
                <button onclick="App.addCustomEditionFromSettings()" class="btn btn-secondary">Add Edition</button>
            </div>
            <div id="customEditionsList"></div>
            <button onclick="App.resetCustomEditions()" class="btn btn-danger">Reset to Defaults</button>
        </div>

        <div class="detail-section">
            <div class="detail-title">üîÑ Reset Settings</div>
            <button onclick="App.resetSettings()" class="btn btn-danger">Reset All Settings to Defaults</button>
        </div>
    </div>

<!-- Design Tab (Admin Only) - CSS Live Designer -->
<div id="design" class="tab-content admin-only">
    <div class="detail-section">
        <div class="detail-title">üé® Live CSS Designer</div>
        <p class="detail-text">Adjust card styles in real-time. Changes save automatically.</p>
        
        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
            <button onclick="CSSDesigner.resetStyles()" class="btn btn-secondary">üîÑ Reset to Defaults</button>
            <button onclick="CSSDesigner.exportCSS()" class="btn">üì• Export CSS</button>
        </div>
    </div>

    <!-- Preview Section -->
    <div class="detail-section">
        <div class="detail-title">üëÅÔ∏è Live Preview</div>
        <div id="cssPreviewContainer" style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 12px; min-height: 300px;">
            <div class="movie-grid grid-cols-3" id="cssPreviewGrid" style="gap: 1rem;">
                <!-- Preview cards will be generated here -->
            </div>
        </div>
    </div>

    <!-- Grid Card Controls -->
    <div class="detail-section">
        <div class="detail-title">üì¶ Grid Card Settings</div>
        
        <div class="form-group">
            <label for="cardBgOpacity">Card Background Opacity: <span id="cardBgOpacityValue">0.12</span></label>
            <input type="range" id="cardBgOpacity" min="0" max="0.3" step="0.01" value="0.12" 
                   onchange="CSSDesigner.updateStyle('cardBgOpacity', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="cardBorderRadius">Card Border Radius: <span id="cardBorderRadiusValue">16px</span></label>
            <input type="range" id="cardBorderRadius" min="0" max="32" step="1" value="16" 
                   onchange="CSSDesigner.updateStyle('cardBorderRadius', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="cardPadding">Card Content Padding: <span id="cardPaddingValue">0.75rem</span></label>
            <input type="range" id="cardPadding" min="0.25" max="2" step="0.05" value="0.75" 
                   onchange="CSSDesigner.updateStyle('cardPadding', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="cardGap">Gap Between Cards: <span id="cardGapValue">1rem</span></label>
            <input type="range" id="cardGap" min="0.25" max="3" step="0.25" value="1" 
                   onchange="CSSDesigner.updateStyle('cardGap', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="cardBorderColor">Card Border Color:</label>
            <input type="color" id="cardBorderColor" value="#ffffff" 
                   onchange="CSSDesigner.updateStyle('cardBorderColor', this.value)">
            <input type="range" id="cardBorderOpacity" min="0" max="1" step="0.05" value="0.25" 
                   onchange="CSSDesigner.updateStyle('cardBorderOpacity', this.value)" class="slider">
            <span id="cardBorderOpacityValue">0.25</span>
        </div>

        <div class="form-group">
            <label for="cardHoverScale">Hover Scale Effect: <span id="cardHoverScaleValue">1.02</span></label>
            <input type="range" id="cardHoverScale" min="1" max="1.15" step="0.01" value="1.02" 
                   onchange="CSSDesigner.updateStyle('cardHoverScale', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="cardHoverLift">Hover Lift (Y): <span id="cardHoverLiftValue">-8px</span></label>
            <input type="range" id="cardHoverLift" min="-20" max="0" step="1" value="-8" 
                   onchange="CSSDesigner.updateStyle('cardHoverLift', this.value)" class="slider">
        </div>
    </div>

    <!-- Poster Settings -->
    <div class="detail-section">
        <div class="detail-title">üñºÔ∏è Poster Settings</div>
        
        <div class="form-group">
            <label for="posterBorderRadius">Poster Border Radius: <span id="posterBorderRadiusValue">16px</span></label>
            <input type="range" id="posterBorderRadius" min="0" max="32" step="1" value="16" 
                   onchange="CSSDesigner.updateStyle('posterBorderRadius', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="posterAspectRatio">Poster Aspect Ratio: <span id="posterAspectRatioValue">2/3</span></label>
            <select id="posterAspectRatio" onchange="CSSDesigner.updateStyle('posterAspectRatio', this.value)">
                <option value="2/3">2:3 (Standard Movie Poster)</option>
                <option value="3/4">3:4 (Slightly Wider)</option>
                <option value="1/1">1:1 (Square)</option>
                <option value="16/9">16:9 (Widescreen)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="posterFit">Poster Image Fit:</label>
            <select id="posterFit" onchange="CSSDesigner.updateStyle('posterFit', this.value)">
                <option value="contain">Contain (Show Full Image)</option>
                <option value="cover">Cover (Fill Space, Crop)</option>
            </select>
        </div>
    </div>

    <!-- Typography Settings -->
    <div class="detail-section">
        <div class="detail-title">üìù Typography Settings</div>
        
        <div class="form-group">
            <label for="titleFontSize">Title Font Size: <span id="titleFontSizeValue">0.95rem</span></label>
            <input type="range" id="titleFontSize" min="0.6" max="1.5" step="0.05" value="0.95" 
                   onchange="CSSDesigner.updateStyle('titleFontSize', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="titleFontWeight">Title Font Weight: <span id="titleFontWeightValue">700</span></label>
            <input type="range" id="titleFontWeight" min="400" max="900" step="100" value="700" 
                   onchange="CSSDesigner.updateStyle('titleFontWeight', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="titleLineClamp">Title Max Lines: <span id="titleLineClampValue">2</span></label>
            <input type="range" id="titleLineClamp" min="1" max="4" step="1" value="2" 
                   onchange="CSSDesigner.updateStyle('titleLineClamp', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="infoFontSize">Info Font Size: <span id="infoFontSizeValue">0.8rem</span></label>
            <input type="range" id="infoFontSize" min="0.5" max="1.2" step="0.05" value="0.8" 
                   onchange="CSSDesigner.updateStyle('infoFontSize', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="infoOpacity">Info Text Opacity: <span id="infoOpacityValue">0.9</span></label>
            <input type="range" id="infoOpacity" min="0.3" max="1" step="0.05" value="0.9" 
                   onchange="CSSDesigner.updateStyle('infoOpacity', this.value)" class="slider">
        </div>
    </div>

    <!-- Shadow Settings -->
    <div class="detail-section">
        <div class="detail-title">üå´Ô∏è Shadow & Effects</div>
        
        <div class="form-group">
            <label for="cardShadowBlur">Card Shadow Blur: <span id="cardShadowBlurValue">25px</span></label>
            <input type="range" id="cardShadowBlur" min="0" max="50" step="1" value="25" 
                   onchange="CSSDesigner.updateStyle('cardShadowBlur', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="cardShadowOpacity">Card Shadow Opacity: <span id="cardShadowOpacityValue">0.1</span></label>
            <input type="range" id="cardShadowOpacity" min="0" max="0.5" step="0.01" value="0.1" 
                   onchange="CSSDesigner.updateStyle('cardShadowOpacity', this.value)" class="slider">
        </div>

        <div class="form-group">
            <label for="cardBlur">Card Backdrop Blur: <span id="cardBlurValue">20px</span></label>
            <input type="range" id="cardBlur" min="0" max="40" step="1" value="20" 
                   onchange="CSSDesigner.updateStyle('cardBlur', this.value)" class="slider">
        </div>
    </div>
</div>

    <!-- Modals -->
    <div id="searchModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Search Results</h3>
                <span class="close" onclick="App.closeModal('searchModal')">&times;</span>
            </div>
            <div id="searchResults"></div>
            <div style="text-align: center; margin-top: 1rem;">
                <button onclick="App.useWithoutData()" class="btn btn-secondary">Use Title Without Database Info</button>
            </div>
        </div>
    </div>

    <div id="detailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close" onclick="App.closeModal('detailModal')">&times;</span>
            </div>
            <div id="movieDetail"></div>
        </div>
    </div>
</div>

    <!-- Barcode Scanner Modal -->
    <div id="scannerModal" class="modal">
        <div class="modal-content scanner-modal-content">
            <div class="modal-header">
                <h3>üì± Scan UPC Barcode</h3>
                <span class="close" onclick="BarcodeScanner.close()">&times;</span>
            </div>
            <div class="scanner-container">
                <div id="barcodeScanner"></div>
                <div id="scannerOverlay" class="scanner-overlay">
                    <div class="scanner-line"></div>
                    <div class="scanner-corners"></div>
                </div>
                <div id="scannerPlaceholder" class="scanner-placeholder">
                    <p>üì∑ Initializing camera...</p>
                    <p style="font-size: 0.9rem; opacity: 0.8;">Point camera at UPC barcode</p>
                </div>
            </div>
            <div style="text-align: center; margin-top: 1rem; color: white;">
                <p>üì± Point your camera at a UPC/EAN barcode</p>
                <p style="font-size: 0.85rem; opacity: 0.8;">Works best with good lighting and steady hands</p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/barcode-scanner.js"></script>
    <script src="js/cover-scanner.js"></script>
    <script src="js/service-worker.js"></script>
    <script src="js/css-designer.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            App.init();
            
            // Initialize cover scanner if available
            if (typeof CoverScanner !== 'undefined') {
                CoverScanner.init();
            }
            
            // Initialize barcode scanner if available
            if (typeof BarcodeScanner !== 'undefined') {
                BarcodeScanner.init();
            }
        });
    </script>
</body>
</html>